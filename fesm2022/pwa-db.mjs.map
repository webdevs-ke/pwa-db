{"version":3,"file":"pwa-db.mjs","sources":["../../../projects/pwa-db/src/lib/core/indexeddb.service.ts","../../../projects/pwa-db/src/lib/core/table.model.ts","../../../projects/pwa-db/src/lib/core/database.service.ts","../../../projects/pwa-db/src/lib/sql/sql-parser.ts","../../../projects/pwa-db/src/lib/sql/sql-engine.service.ts","../../../projects/pwa-db/src/lib/pwa-db.ts","../../../projects/pwa-db/src/public-api.ts","../../../projects/pwa-db/src/pwa-db.ts"],"sourcesContent":["import { Injectable } from '@angular/core'\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class IndexedDbService {\r\n  private db!: IDBDatabase\r\n  private opened = false\r\n\r\n  constructor() { }\r\n\r\n  async open() {\r\n    if(this.opened) return\r\n    if(typeof window === 'undefined' || !window.indexedDB) return\r\n\r\n    this.opened = true\r\n\r\n    return new Promise<void>((resolve, reject) => {\r\n      const req = window.indexedDB.open('pwa-db', 1)\r\n\r\n      req.onupgradeneeded = () => {\r\n        const db = req.result\r\n        if (!db.objectStoreNames.contains('tables')) {\r\n          db.createObjectStore('tables')\r\n        }\r\n      }\r\n      req.onsuccess = () => {\r\n        this.db = req.result\r\n        resolve()\r\n      }\r\n      req.onerror = () => reject(req.error)\r\n    })\r\n  }\r\n\r\n  async saveTable(name: string, data: any): Promise<void> {\r\n    return new Promise((resolve, reject) => {\r\n      if (!this.db) return resolve()  \r\n      const tx = this.db.transaction('tables', 'readwrite')\r\n      tx.objectStore('tables').put(data, name)\r\n      tx.oncomplete = () => resolve()\r\n      tx.onerror = () => reject(tx.error)\r\n    })\r\n  }  \r\n\r\n  async loadTable(name: string): Promise<any> {\r\n    return new Promise(resolve => {\r\n      if (!this.db) return resolve(null)\r\n      const tx = this.db.transaction('tables')\r\n      const req = tx.objectStore('tables').get(name)\r\n      req.onsuccess = () => resolve(req.result)\r\n    })\r\n  }\r\n\r\n  async deleteTable(name: string): Promise<void> {\r\n    return new Promise((resolve, reject) => {\r\n      if (!this.db) return resolve()\r\n      const tx = this.db.transaction('tables', 'readwrite')\r\n      const store = tx.objectStore('tables')\r\n      store.delete(name)\r\n      tx.oncomplete = () => resolve()\r\n      tx.onerror = () => reject(tx.error)\r\n      tx.onabort = () => reject(tx.error)\r\n    })\r\n  }  \r\n\r\n  async tableExists(name: string): Promise<boolean> {\r\n    return new Promise(resolve => {\r\n      if (!this.db) return resolve(false)\r\n      const tx = this.db.transaction('tables', 'readonly')\r\n      const req = tx.objectStore('tables').get(name)\r\n  \r\n      req.onsuccess = () => resolve(!!req.result)\r\n      req.onerror = () => resolve(false)\r\n    })\r\n  }  \r\n\r\n  async iterateKeys(cb: (key: IDBValidKey) => void): Promise<void> {\r\n    return new Promise(resolve => {\r\n      const tx = this.db.transaction('tables')\r\n      const store = tx.objectStore('tables')\r\n      const req = store.openCursor()\r\n  \r\n      req.onsuccess = () => {\r\n        const cursor = req.result\r\n        if (!cursor) return resolve()\r\n        cb(cursor.key)\r\n        cursor.continue()\r\n      }\r\n    })\r\n  }\r\n  \r\n  async deleteByPrefix(prefix: string) {\r\n    const tx = this.db.transaction('tables', 'readwrite')\r\n    const store = tx.objectStore('tables')\r\n    const req = store.openCursor() \r\n    req.onsuccess = () => {\r\n      const cursor = req.result\r\n      if (!cursor) return\r\n  \r\n      const key = cursor.key\r\n      if (typeof key === 'string' && key.startsWith(prefix)) {\r\n        cursor.delete()\r\n      }\r\n      cursor.continue()\r\n    }\r\n  }  \r\n}","import { Column } from \"./column.model\"\r\nimport { AlterAction } from \"../sql/sql-ast\"\r\n\r\nexport class Table {\r\n    name: string\r\n    columns: Column[]\r\n    rows: any[]\r\n    indexes = new Map<string, Map<any, any>>()\r\n  \r\n    constructor(name: string, columns: Column[], rows: any[]) {\r\n      this.name = name\r\n      this.columns = columns\r\n      this.rows = rows\r\n  \r\n      for (const c of columns) {\r\n        if (c.primary || c.unique) {\r\n          this.indexes.set(c.name, new Map())\r\n        }\r\n      }\r\n    }\r\n  \r\n    insert(row: any) {\r\n      for (const col of this.columns) {\r\n        if (col.primary || col.unique) {\r\n          const idx = this.indexes.get(col.name)!\r\n          if (idx.has(row[col.name])) {\r\n            throw new Error(`Duplicate value for ${col.name}`)\r\n          }\r\n          idx.set(row[col.name], row)\r\n        }\r\n      }\r\n      this.rows.push(row)\r\n    }\r\n  \r\n    select(where?: { col: string, value: any }, columns: string[] = ['*']): any[] {\r\n      let result: any[]\r\n\r\n      if (!where) result = [...this.rows]\r\n      else {\r\n        const idx = this.indexes.get(where.col)\r\n        if (idx && idx.has(where.value)) {\r\n          result = [idx.get(where.value)]\r\n        } else {\r\n          result = this.rows.filter(r => r[where.col] === where.value)\r\n        }\r\n      }\r\n      // '*' returns full rows\r\n      if (columns.length === 1 && columns[0] === '*') {\r\n        return result\r\n      }\r\n      // validate + project\r\n      return result.map(row => {\r\n        const projected: any = {}\r\n\r\n        for (const col of columns) {\r\n          if (!(col in row)) {\r\n            throw new Error(`Unknown column '${col}'`)\r\n          }\r\n          projected[col] = row[col]\r\n        }\r\n\r\n        return projected\r\n      })\r\n    }\r\n  \r\n    update(where: { col: string; value: any }, changes: any) {\r\n      for (const row of this.rows) {\r\n        if (row[where.col] === where.value) {\r\n          Object.assign(row, changes)\r\n        }\r\n      }\r\n    }\r\n      \r\n    delete(where: { col: string, value: any }) {\r\n      this.rows = this.rows.filter(r => r[where.col] !== where.value)\r\n      const idx = this.indexes.get(where.col)\r\n      if (idx) idx.delete(where.value)\r\n    }\r\n\r\n    applyAlter(action: AlterAction) {\r\n      switch (action.type) {    \r\n        case 'ADD_COLUMN': {\r\n          if (this.columns.some(c => c.name === action.column.name)) {\r\n            throw new Error('Column already exists')\r\n          }    \r\n          this.columns.push(action.column)    \r\n          // initialize existing rows\r\n          for (const row of this.rows) {\r\n            row[action.column.name] = null\r\n          }\r\n          break\r\n        }\r\n    \r\n        case 'DROP_COLUMN': {\r\n          const idx = this.columns.findIndex(c => c.name === action.column)\r\n          if (idx === -1) throw new Error('Column not found')\r\n    \r\n          const col = this.columns[idx]\r\n          if (col.primary) throw new Error('Cannot drop PRIMARY KEY')\r\n    \r\n          this.columns.splice(idx, 1)\r\n          for (const row of this.rows) {\r\n            delete row[action.column]\r\n          }\r\n          break\r\n        }\r\n    \r\n        case 'RENAME_COLUMN': {\r\n          const col = this.columns.find(c => c.name === action.from)\r\n          if (!col) throw new Error('Column not found')\r\n    \r\n          if (this.columns.some(c => c.name === action.to)) {\r\n            throw new Error('Target column already exists')\r\n          }\r\n    \r\n          col.name = action.to\r\n          for (const row of this.rows) {\r\n            row[action.to] = row[action.from]\r\n            delete row[action.from]\r\n          }\r\n          break\r\n        }\r\n      }\r\n    }    \r\n  }","import { Injectable } from '@angular/core';\r\nimport { Table } from './table.model';\r\nimport { Column } from './column.model';\r\nimport { IndexedDbService } from './indexeddb.service';\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class DatabaseService {\r\n  private currentDB = 'default'\r\n  private databases = new Set<string>()\r\n  tables = new Map<string, Table>();\r\n\r\n  constructor(private store: IndexedDbService) {\r\n    this.init()\r\n  }\r\n\r\n  private async init() {\r\n    await this.store.open()\r\n    const saved = await this.store.loadTable('__databases__')\r\n\r\n    if (saved) this.databases = new Set(saved)\r\n    else {\r\n      this.databases.add('default')\r\n      await this.persistDatabases()\r\n    }\r\n    await this.useDatabase('default')\r\n  }\r\n\r\n  async useDatabase(name: string) {\r\n    if (!this.databases.has(name)) {\r\n      throw new Error(`Database ${name} does not exist`)\r\n    }  \r\n    this.currentDB = name\r\n    this.tables.clear()\r\n  }\r\n  \r\n  private async persistDatabases() {\r\n    await this.store.saveTable('__databases__', [...this.databases])\r\n  }\r\n\r\n  async createDatabase(name: string) {\r\n    if (this.databases.has(name)) return\r\n  \r\n    this.databases.add(name)\r\n    await this.persistDatabases()\r\n  }\r\n\r\n  async listDatabases(): Promise<string[]> {\r\n    return [...this.databases]\r\n  }  \r\n  \r\n  async listTables(): Promise<string[]> {\r\n    const prefix = `${this.currentDB}::`\r\n    const tables: string[] = []\r\n  \r\n    await this.store.iterateKeys(key => {\r\n      if (typeof key === 'string' && key.startsWith(prefix)) {\r\n        tables.push(key.replace(prefix, ''))\r\n      }\r\n    })  \r\n    return tables\r\n  }\r\n  \r\n  async dropDatabase(name: string) {\r\n    if (name === 'default') {\r\n      throw new Error('Cannot drop default database')\r\n    }  \r\n    if (!this.databases.has(name)) return\r\n  \r\n    this.databases.delete(name)\r\n    await this.persistDatabases()  \r\n    // delete all tables belonging to this DB\r\n    await this.store.deleteByPrefix(`${name}::`)\r\n  \r\n    if (this.currentDB === name) {\r\n      await this.useDatabase('default')\r\n    }\r\n  }\r\n  \r\n  async createTable(name: string, columns: Column[]) {\r\n    const key = `${this.currentDB}::${name}`\r\n    if (this.tables.has(name)) return\r\n  \r\n    const table = new Table(name, columns, [])\r\n    const saved = await this.store.loadTable(key)\r\n  \r\n    if (saved) Object.assign(table, saved)\r\n  \r\n    this.tables.set(name, table)  // insert into memory\r\n    await this.store.saveTable(key, this.tables.get(name))  // insert into IndexedDB (from memory)\r\n  }\r\n \r\n  async dropTable(tableName: string): Promise<void> {\r\n    const key = `${this.currentDB}::${tableName}`\r\n    const exists = await this.store.tableExists(key)\r\n  \r\n    if (!exists) {\r\n      throw new Error(`Table ${tableName} does not exist`)\r\n    }\r\n    await this.store.deleteTable(key)  // remove from IndexedDB\r\n    this.tables.delete(tableName)  // remove from memory\r\n  }\r\n\r\n  async renameTable(oldName: string, newName: string): Promise<Table> {\r\n    if (this.tables.has(newName)) {\r\n      throw new Error('Target table already exists')\r\n    }  \r\n    const oldKey = `${this.currentDB}::${oldName}`\r\n    const newKey = `${this.currentDB}::${newName}`  \r\n    const table = await this.table(oldName)  \r\n    table.name = newName  // update table object  \r\n    await this.store.saveTable(newKey, table)  // persist under new key    \r\n    await this.store.deleteByPrefix(oldKey)  // remove old key\r\n    this.tables.delete(oldName)  // update in-memory map\r\n    this.tables.set(newName, table)\r\n  \r\n    return table\r\n  }  \r\n  \r\n  async insert(tableName: string, row: any): Promise<Table> {\r\n    const table = await this.table(tableName)\r\n    table.insert(row)\r\n    this.persist(tableName)\r\n    return table\r\n  }\r\n  \r\n  async update(tableName: string, where: any, set: any): Promise<Table> {\r\n    const table = await this.table(tableName)\r\n    table.update(where, set)\r\n    this.persist(tableName)\r\n    return table\r\n  }\r\n  \r\n  async delete(tableName: string, where: any): Promise<Table> {\r\n    const table = await this.table(tableName)\r\n    table.delete(where)\r\n    this.persist(tableName)\r\n    return table\r\n  }\r\n \r\n  async select (tableName: string, where: any, columns: string[] = ['*']): Promise<Table> {\r\n    const table = await this.table(tableName)\r\n    table.select(where, columns)\r\n    return table\r\n  }\r\n\r\n  persist(name: string) {\r\n    const key = `${this.currentDB}::${name}`\r\n    this.store.saveTable(key, this.tables.get(name))\r\n  }\r\n  \r\n  async table(name: string): Promise<Table> {\r\n    let table = this.tables.get(name)  // try loading table from memory\r\n    if (!table)  // table does not exist in memory\r\n      table = await this.loadTable(name)  // try loading table from disk, i.e., IndexedDB\r\n    return table\r\n  }\r\n  \r\n  async loadTable(name: string): Promise<Table> {\r\n    const key = `${this.currentDB}::${name}`  // tables load from current DB\r\n    const saved = await this.store.loadTable(key)\r\n    if (!saved) {\r\n      throw new Error(`Table ${name} does not exist`)\r\n    }\r\n    const table = new Table(  //initialize a table model from saved table's data\r\n      saved.name,\r\n      saved.columns,\r\n      saved.rows ?? []\r\n    )  \r\n    this.tables.set(name, table)  // add table model initialized from disk to memory\r\n    return table\r\n  }\r\n}","import {\r\n    SqlStatement,\r\n    CreateDatabaseStmt,\r\n    UseDatabaseStmt,\r\n    DropDatabaseStmt,\r\n    ShowTablesStmt,\r\n    CreateTableStmt,\r\n    DropTableStmt,\r\n    AlterTableStmt,\r\n    InsertStmt,\r\n    SelectStmt,\r\n    UpdateStmt,\r\n    DeleteStmt\r\n  } from './sql-ast'\r\n  \r\nexport class SqlParser {\r\n    parse(sql: string): SqlStatement {\r\n      sql = sql.trim()\r\n      const upper = sql.toUpperCase()\r\n      \r\n      if (upper.startsWith('CREATE DATABASE')) return this.parseCreateDatabase(sql)\r\n      if (upper.startsWith('DROP DATABASE')) return this.parseDropDatabase(sql)\r\n      if (upper === 'SHOW DATABASES') return { kind: 'SHOW_DATABASES' }\r\n      if (upper.startsWith('USE')) return this.parseUseDatabase(sql)\r\n      if (upper === 'SHOW TABLES') return { kind: 'SHOW_TABLES' }\r\n      if (upper.startsWith('DROP TABLE')) return this.parseDropTable(sql)\r\n      if (upper.startsWith('ALTER TABLE')) return this.parseAlterTable(sql)\r\n\r\n      if (upper.startsWith('CREATE TABLE')) return this.parseCreate(sql)\r\n      if (upper.startsWith('INSERT')) return this.parseInsert(sql)\r\n      if (upper.startsWith('SELECT')) return this.parseSelect(sql)\r\n      if (upper.startsWith('UPDATE')) return this.parseUpdate(sql)\r\n      if (upper.startsWith('DELETE')) return this.parseDelete(sql)\r\n  \r\n      throw new Error('Invalid SQL statement')\r\n    }\r\n  \r\n    private parseCreateDatabase(sql: string): CreateDatabaseStmt {\r\n      const [, name] = /CREATE DATABASE (\\w+)/i.exec(sql) || []\r\n      if (!name) throw new Error(`Invalid CREATE DATABASE syntax: ${sql}`)\r\n      \r\n      return {\r\n        kind: 'CREATE_DATABASE',\r\n        name\r\n      }\r\n    }\r\n      \r\n    private parseDropDatabase(sql: string): DropDatabaseStmt {\r\n      const [, name] = /DROP DATABASE (\\w+)/i.exec(sql) || []\r\n      if (!name) throw new Error(`Invalid DROP DATABASE syntax: ${sql}`)\r\n     \r\n      return {\r\n        kind: 'DROP_DATABASE',\r\n        name\r\n      }\r\n    }\r\n      \r\n    private parseUseDatabase(sql: string): UseDatabaseStmt {\r\n      const [, name] = /USE (\\w+)/i.exec(sql) || []\r\n      if (!name) throw new Error(`Invalid USE syntax: ${sql}`)\r\n     \r\n      return {\r\n        kind: 'USE_DATABASE',\r\n        name\r\n      }\r\n    }\r\n      \r\n    private parseCreate(sql: string): CreateTableStmt {\r\n      const match = /CREATE\\s+TABLE\\s+(\\w+)\\s*\\((.+)\\)/i.exec(sql)!\r\n      if (!match) throw new Error(`Invalid CREATE TABLE syntax: ${sql}`)\r\n      \r\n      const [, table, cols] = match\r\n  \r\n      return {\r\n        kind: 'CREATE_TABLE',\r\n        table,\r\n        columns: cols.split(',').map(c => {\r\n          const p = c.trim().split(/\\s+/)          \r\n          return {\r\n            name: p[0],\r\n            datatype: p[1],\r\n            primary: p.includes('PRIMARY'),\r\n            unique: p.includes('UNIQUE')\r\n          }\r\n        })\r\n      }\r\n    }\r\n  \r\n    private parseDropTable(sql: string): DropTableStmt {\r\n        const match = /DROP TABLE (\\w+)/i.exec(sql)\r\n        if (!match) throw new Error(`Invalid DROP TABLE syntax: ${sql}`)\r\n      \r\n        const [, table] = match\r\n        return {\r\n          kind: 'DROP_TABLE',\r\n          table\r\n        }\r\n    }\r\n\r\n    private parseAlterTable(sql: string): AlterTableStmt {\r\n        // normalize spacing\r\n        sql = sql.trim().replace(/\\s+/g, ' ')\r\n      \r\n        let m = /^ALTER TABLE (\\w+) ADD COLUMN (\\w+) (\\w+)/i.exec(sql)\r\n        if (m) {\r\n          const [, table, name, datatype] = m\r\n          return {\r\n            kind: 'ALTER_TABLE',\r\n            table,\r\n            actions: [{\r\n              type: 'ADD_COLUMN',\r\n              column: {\r\n                name,\r\n                type: datatype as any,\r\n                primary: false,\r\n                unique: false\r\n              }\r\n            }]\r\n          }\r\n        }\r\n      \r\n        m = /^ALTER TABLE (\\w+) DROP COLUMN (\\w+)/i.exec(sql)\r\n        if (m) {\r\n          const [, table, column] = m\r\n          return {\r\n            kind: 'ALTER_TABLE',\r\n            table,\r\n            actions: [{ type: 'DROP_COLUMN', column }]\r\n          }\r\n        }\r\n      \r\n        m = /^ALTER TABLE (\\w+) RENAME COLUMN (\\w+) TO (\\w+)/i.exec(sql)\r\n        if (m) {\r\n          const [, table, from, to] = m\r\n          return {\r\n            kind: 'ALTER_TABLE',\r\n            table,\r\n            actions: [{ type: 'RENAME_COLUMN', from, to }]\r\n          }\r\n        }\r\n      \r\n        m = /^ALTER TABLE (\\w+) RENAME TO (\\w+)/i.exec(sql)\r\n        if (m) {\r\n          const [, table, to] = m\r\n          return {\r\n            kind: 'ALTER_TABLE',\r\n            table,\r\n            actions: [{ type: 'RENAME_TABLE', to }]\r\n          }\r\n        }      \r\n        throw new Error(`Invalid ALTER TABLE syntax: {$sql}`)\r\n    }      \r\n      \r\n    private parseInsert(sql: string): InsertStmt {\r\n      const match = /INSERT\\s+INTO\\s(\\w+)\\s+VALUES\\s*\\((.+)\\)\\s*;?/i.exec(sql)!\r\n      if (!match) throw new Error(`Invalid INSERT syntax: ${sql}`)\r\n\r\n      const [, table, vals] = match\r\n  \r\n      return {\r\n        kind: 'INSERT',\r\n        table,\r\n        values: this.splitValues(vals)\r\n      }\r\n    }\r\n   \r\n    private parseSelect(sql: string): SelectStmt {\r\n      const match = /SELECT\\s+(.+?)\\s+FROM\\s+(\\w+)(?:\\s+WHERE\\s+(\\w+)\\s*=\\s*(.+))?\\s*;?/i.exec(sql)\r\n      if (!match) throw new Error(`Invalid SELECT syntax: ${sql}`)\r\n\r\n      const [, cols, table, col, val] = match\r\n  \r\n      return {\r\n        kind: 'SELECT',\r\n        table,\r\n        columns: cols.trim() === '*'\r\n          ? ['*']\r\n          : cols.split(',').map(c => c.trim()),\r\n        where: col\r\n          ? { col, value: this.cleanValue(val) }\r\n          : undefined\r\n      }\r\n    }\r\n  \r\n    private parseUpdate(sql: string): UpdateStmt {\r\n        const match = /UPDATE\\s+(\\w+)\\s+SET\\s+(.+?)\\s+WHERE\\s+(\\w+)\\s*=\\s*(.+)\\s*;?/i.exec(sql)      \r\n        if (!match) throw new Error(`Invalid UPDATE syntax: ${sql}`)\r\n\r\n        const [, table, setPart, col, val] = match      \r\n        const changes: Record<string, any> = {}\r\n      \r\n        this.splitAssignments(setPart).forEach(p => {\r\n          const [k, v] = p.split('=')\r\n          changes[k.trim()] = this.cleanValue(v)\r\n        })          \r\n      \r\n        return {\r\n          kind: 'UPDATE',\r\n          table,\r\n          set: changes,\r\n          where: { col, value: this.cleanValue(val) }\r\n        }\r\n    }\r\n    \r\n    private parseDelete(sql: string): DeleteStmt {\r\n        const match = /DELETE\\s+FROM\\s+(\\w+)\\s+WHERE\\s+(\\w+)\\s*=\\s*(.+)\\s*;?/i.exec(sql)      \r\n        if (!match) throw new Error(`Invalid DELETE syntax: ${sql}`)\r\n\r\n        const [, table, col, val] = match\r\n      \r\n        return {\r\n          kind: 'DELETE',\r\n          table,\r\n          where: { col, value: this.cleanValue(val) }\r\n        }\r\n    }      \r\n\r\n    private cleanValue(v: string): string {\r\n      if (v == null) throw new Error('Invalid WHERE clause')\r\n      return v\r\n        .trim()\r\n        .replace(/^'(.*)'$/, '$1')\r\n        .replace(/^\"(.*)\"$/, '$1')\r\n    }\r\n\r\n    private splitValues(input: string): string[] {\r\n        const values: string[] = []\r\n        let current = ''\r\n        let inString = false\r\n      \r\n        for (let i = 0; i < input.length; i++) {\r\n          const ch = input[i]      \r\n          if (ch === \"'\" && input[i - 1] !== '\\\\') {\r\n            inString = !inString\r\n            continue\r\n          }      \r\n          if (ch === ',' && !inString) {\r\n            values.push(current.trim())\r\n            current = ''\r\n            continue\r\n          }      \r\n          current += ch\r\n        }      \r\n        if (current) values.push(current.trim())\r\n      \r\n        return values.map(v => v.replace(/^'(.*)'$/, '$1'))\r\n    }\r\n     \r\n    private splitAssignments(input: string): string[] {\r\n        const parts: string[] = []\r\n        let current = ''\r\n        let inString = false\r\n      \r\n        for (let i = 0; i < input.length; i++) {\r\n          const ch = input[i]      \r\n          if (ch === \"'\" && input[i - 1] !== '\\\\') {\r\n            inString = !inString\r\n            current += ch\r\n            continue\r\n          }      \r\n          if (ch === ',' && !inString) {\r\n            parts.push(current.trim())\r\n            current = ''\r\n            continue\r\n          }      \r\n          current += ch\r\n        }      \r\n        if (current) parts.push(current.trim())\r\n        return parts\r\n    }      \r\n}    ","import { Injectable } from '@angular/core'\r\nimport { DatabaseService } from '../core/database.service'\r\nimport { SqlParser } from './sql-parser'\r\nimport { SqlStatement } from './sql-ast'\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class SqlEngineService {\r\n  private parser = new SqlParser()\r\n\r\n  constructor(private db: DatabaseService) {}\r\n\r\n  async execute(sql: string) {\r\n    const ast = this.parser.parse(sql)\r\n    return this.executeAst(ast)\r\n  }\r\n\r\n  private async executeAst(stmt: SqlStatement): Promise<any> {\r\n    switch (stmt.kind) {\r\n  \r\n      case 'CREATE_DATABASE':\r\n        await this.db.createDatabase(stmt.name)\r\n        return `Database ${stmt.name} created`\r\n  \r\n      case 'DROP_DATABASE':\r\n        await this.db.dropDatabase(stmt.name)\r\n        return `Database ${stmt.name} dropped`\r\n  \r\n      case 'SHOW_DATABASES':\r\n        return await this.db.listDatabases()\r\n  \r\n      case 'USE_DATABASE':\r\n        await this.db.useDatabase(stmt.name)       \r\n        return `Using database ${stmt.name}`\r\n\r\n      case 'SHOW_TABLES': {\r\n        const tables = await this.db.listTables()\r\n        return {\r\n          type: 'TABLE_LIST',\r\n          tables\r\n        }\r\n      }        \r\n\r\n      case 'DROP_TABLE': {\r\n        await this.db.dropTable(stmt.table)\r\n        return `Table ${stmt.table} dropped`\r\n      }\r\n\r\n      case 'ALTER_TABLE': {\r\n        const action = stmt.actions[0]\r\n      \r\n        if (action.type === 'RENAME_TABLE') {\r\n          const table = await this.db.renameTable(stmt.table, action.to)\r\n          return {\r\n            type: 'TABLE_SCHEMA',\r\n            table: table.name,\r\n            columns: table.columns\r\n          }\r\n        }\r\n      \r\n        const table = await this.db.table(stmt.table)\r\n        for (const a of stmt.actions) {\r\n          table.applyAlter(a)\r\n        }      \r\n        this.db.persist(table.name)\r\n      \r\n        return {\r\n          type: 'TABLE_SCHEMA',\r\n          table: table.name,\r\n          columns: table.columns\r\n        }\r\n      }\r\n      \r\n      case 'CREATE_TABLE': {\r\n        await this.db.createTable(\r\n          stmt.table,\r\n          stmt.columns.map(c => ({\r\n            name: c.name,\r\n            type: c.datatype as any,\r\n            primary: c.primary,\r\n            unique: c.unique\r\n          }))\r\n        )\r\n        const table = await this.db.table(stmt.table)\r\n        return {\r\n          type: 'TABLE_SCHEMA',\r\n          table: table.name,\r\n          columns: table.columns\r\n        }\r\n      }\r\n    \r\n      case 'INSERT': {\r\n        const row: any = {}\r\n        const table = await this.db.table(stmt.table)\r\n        table.columns.forEach((c, i) => row[c.name] = stmt.values[i])\r\n      \r\n        const updated = await this.db.insert(stmt.table, row)        \r\n        return {\r\n          type: 'TABLE_DATA',\r\n          table: updated.name,\r\n          rows: updated.rows\r\n        }\r\n      }        \r\n\r\n      case 'SELECT': {\r\n        const table = await this.db.select(stmt.table, stmt.where, stmt.columns)\r\n        return {\r\n          type: 'TABLE_DATA',\r\n          table: table.name,\r\n          rows: table.rows\r\n        }\r\n      }\r\n\r\n      case 'UPDATE': {\r\n        const updated = await this.db.update(stmt.table, stmt.where, stmt.set)        \r\n        return {\r\n          type: 'TABLE_DATA',\r\n          table: updated.name,\r\n          rows: updated.rows\r\n        }\r\n      }\r\n            \r\n      case 'DELETE': {\r\n        const updated = await this.db.delete(stmt.table, stmt.where)        \r\n        return {\r\n          type: 'TABLE_DATA',\r\n          table: updated.name,\r\n          rows: updated.rows\r\n        }\r\n      }        \r\n    }\r\n  }  \r\n}","import { Component } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'lib-pwa-db',\r\n  imports: [],\r\n  template: `\r\n    <p>\r\n      pwa-db works!\r\n    </p>\r\n  `,\r\n  styles: ``,\r\n})\r\nexport class PwaDb {\r\n\r\n}\r\n","/*\r\n * Public API Surface of pwa-db\r\n * Author: benkatiku.netlify.app\r\n */\r\n\r\n// core\r\nexport * from './lib/core/indexeddb.service'\r\nexport * from './lib/core/column.model'\r\nexport * from './lib/core/table.model'\r\nexport * from './lib/core/database.service'\r\n\r\n// sql\r\nexport * from './lib/sql/sql-ast'\r\nexport * from './lib/sql/sql-parser'\r\nexport * from './lib/sql/sql-engine.service'\r\n\r\nexport * from './lib/pwa-db'\r\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":["i1.IndexedDbService","i1.DatabaseService"],"mappings":"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"}